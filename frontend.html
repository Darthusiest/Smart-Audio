<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Smart Audio Summarizer & Translator</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; }
    .card { max-width: 720px; margin: 0 auto; padding: 1.5rem; border: 1px solid #e5e7eb; border-radius: 12px; box-shadow: 0 1px 4px rgba(0,0,0,0.06); }
    label { display:block; margin: 0.75rem 0 0.25rem; font-weight: 600; }
    select, input[type="file"], button { width: 100%; padding: 0.6rem; border: 1px solid #cbd5e1; border-radius: 8px; }
    button { cursor: pointer; font-weight: 600; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    .muted { color: #145ec7; font-size: 0.9rem; }
    .log { white-space: pre-wrap; background: #f8fafc; border:1px dashed #cbd5e1; border-radius:8px; padding:0.75rem; margin-top:1rem; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .success { color: #166534; }
    .error { color: #991b1b; }
    .link { margin-top: 0.75rem; }
    #go {
  background: #0d6efd;   /* blue */
  color: #fff;
  border: none;
}
#go:hover { background: #0b5ed7; }
#go:disabled { background: #9ec5fe; cursor: not-allowed; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Smart Audio Summarizer & Translator</h1>
    <p class="muted">Upload an audio file, pick your options, and get a summary + translation.</p>

    <label for="audio">Audio file</label>
    <input id="audio" type="file" accept="audio/*" />

    <div class="row">
      <div>
        <label for="language">Target language</label>
        <select id="language">
          <option value="en">English (en)</option>
          <option value="es">Spanish (es)</option>
          <option value="fr">French (fr)</option>
          <option value="de">German (de)</option>
          <option value="it">Italian (it)</option>
          <option value="pt">Portuguese (pt)</option>
        </select>
      </div>
      <div>
        <label for="format">Output format</label>
        <select id="format">
          <option value="pdf">PDF</option>
          <option value="txt">TXT</option>
          <option value="json">JSON</option>
        </select>
      </div>
    </div>

    <label for="style">Summary style</label>
    <select id="style">
      <option value="concise">Concise</option>
      <option value="detailed">Detailed</option>
      <option value="bullet">Bullet</option>
      <option value="academic">Academic</option>
    </select>

    <button id="go" style="margin-top:1rem">Process</button>

    <div id="status" class="log"></div>
    <div id="download" class="link"></div>
  </div>

  <script>
    // Adjust if hosting API elsewhere
    const API_BASE = "http://localhost:5000";

    const $ = (id) => document.getElementById(id);

    $("go").addEventListener("click", async () => {
      const fileInput = $("audio");
      const lang = $("language").value;
      const format = $("format").value;
      const style = $("style").value;
      const status = $("status");
      const link = $("download");

      link.innerHTML = "";
      status.textContent = "";

      if (!fileInput.files.length) {
        status.innerHTML = '<span class="error">Please choose an audio file.</span>';
        return;
      }

      const form = new FormData();
      form.append("audio", fileInput.files[0]);
      form.append("language", lang);
      form.append("format", format);
      form.append("style", style);

      status.textContent = "Uploading and processing... This may take a moment.";

      try {
        const resp = await fetch(`${API_BASE}/api/process`, {
          method: "POST",
          body: form
        });
        const data = await resp.json();

        if (!resp.ok) {
          status.innerHTML = `<span class="error">Error: ${data.error || resp.statusText}</span>`;
          return;
        }

        status.innerHTML = `<span class="success">Success! File generated: ${data.filename}</span>`;
        link.innerHTML = `<a href="${API_BASE}${data.download_url}">Download result</a>`;
      } catch (e) {
        status.innerHTML = `<span class="error">Request failed: ${e.message}</span>`;
      }
    });
  </script>
</body>
</html>